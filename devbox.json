{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/0.12.0/.schema/devbox.schema.json",
  "packages": [
    "go-tools@latest",
    "git-extras@latest",
    "go@1.23"
  ],
  "env": {
    "QUOTES_SOURCE_URL": "https://raw.githubusercontent.com/AkashRajpurohit/the-office-api/main/data/quotes.json"
  },
  "shell": {
    "init_hook": [],
    "scripts": {
      "compile": [
        "set -x",
        "curl -s \"$QUOTES_SOURCE_URL\" | jq -c -r \"map(del(.id, .character_avatar_url))\" > quotes.json",
        "go build -ldflags \"-s -w -X main.version=\"$(VERSION=$(git tag --sort=-creatordate | head -n 1); [ -z \"$VERSION\" ] && VERSION=\"dev-build\"; echo \"$VERSION\")\"\" -o ./.bin/"
      ],
      "check:format": [
        "set -x",
        "gofmt -d -e -l ."
      ],
      "check:lint": [
        "set -x",
        "staticcheck ."
      ],
      "version": [
        "git changelog CHANGELOG.md --tag \"$1\"",
        "git add CHANGELOG.md",
        "git release \"$1\""
      ]
    }
  }
}
