{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/0.12.0/.schema/devbox.schema.json",
  "packages": [
    "git-extras@latest",
    "go@1.23",
    "runx:golangci/golangci-lint@latest",
    "runx:mvdan/gofumpt@latest"
  ],
  "env": {
    "QUOTES_SOURCE_URL": "https://raw.githubusercontent.com/AkashRajpurohit/the-office-api/main/data/quotes.json"
  },
  "shell": {
    "init_hook": [],
    "scripts": {
      "compile": [
        "set -x",
        "curl -s \"$QUOTES_SOURCE_URL\" | jq -c -r \"map(del(.id, .character_avatar_url))\" > quotes.json",
        "go build -ldflags \"-s -w -X main.version=\"$(VERSION=$(git tag --sort=-creatordate | head -n 1); [ -z \"$VERSION\" ] && VERSION=\"dev-build\"; echo \"$VERSION\")\"\" -o ./.bin/"
      ],
      "check:format": [
        "set -x",
        "gofumpt -d -e -l -extra $(find . -name '*.go')"
      ],
      "check:lint": [
        "set -x",
        "golangci-lint run --timeout 5m"
      ],
      "version": "git release -c CHANGELOG.md --semver \"$1\""
    }
  }
}
